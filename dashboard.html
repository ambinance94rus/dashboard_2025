<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Wildberries Analytics Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
* {margin:0; padding:0; box-sizing:border-box;}
html {scroll-behavior: smooth;}
body {font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:#333; min-height:100vh; padding:20px;}
.container {max-width:1600px; margin:0 auto; background:#fff; border-radius:16px; box-shadow:0 25px 80px rgba(0,0,0,0.35); overflow:hidden;}
header {background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white; padding:30px; text-align:center;}
header h1 {font-size:2.5em; margin-bottom:10px; font-weight:800;}
header p {font-size:1em; opacity:0.9;}
.period-selector {background:#f0f4ff; padding:20px; border-bottom:2px solid #667eea; display:flex; align-items:center; gap:20px; flex-wrap:wrap;}
.period-selector label {font-weight:700; color:#667eea; font-size:1.1em;}
.period-selector select {padding:10px 16px; border-radius:8px; border:2px solid #667eea; font-size:1em; cursor:pointer; font-weight:600; background:#fff;}
.tabs {display:flex; background:#f8f9fa; border-bottom:3px solid #667eea; overflow-x:auto; flex-wrap:wrap;}
.tab-button {padding:18px 28px; background:none; border:none; cursor:pointer; font-size:1em; color:#666; border-bottom:4px solid transparent; font-weight:600; user-select:none; transition:0.3s; white-space:nowrap;}
.tab-button:hover {background:#e8ecff; color:#667eea;}
.tab-button.active {color:#fff; background:#667eea; border-bottom-color:#764ba2;}
.tab-content {display:none; padding:40px; animation:fadeIn 0.4s;}
.tab-content.active {display:block;}
@keyframes fadeIn {from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);}}
h2 {color:#667eea; margin-bottom:25px; font-size:2em; border-bottom:3px solid #667eea; padding-bottom:15px;}
h3 {color:#667eea; margin-top:30px; margin-bottom:20px; font-size:1.4em;}
table {width:100%; border-collapse:collapse; background:#fff; font-size:0.95em; margin-top:20px; box-shadow:0 2px 8px rgba(0,0,0,0.08);}
th, td {padding:14px; border-bottom:1px solid #e8e8e8; text-align:left;}
th {background:#667eea; color:#fff; position:sticky; top:0; z-index:10; font-weight:700;}
tbody tr:hover {background:#f5f5ff;}
.metrics-grid {display:grid; grid-template-columns:repeat(auto-fit, minmax(200px,1fr)); gap:20px; margin-bottom:35px;}
.metric-card {background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:#fff; padding:20px; border-radius:12px; box-shadow:0 8px 24px rgba(102, 126, 234, 0.3); text-align:center;}
.metric-card h3 {color:#fff; font-size:1em; margin:0 0 10px 0; opacity:0.9;}
.metric-card .value {font-size:2em; font-weight:800;}
.metric-card .subtitle {font-size:0.9em; opacity:0.85; margin-top:8px;}
.scroll-table {overflow-x:auto; border-radius:8px;}
.category-section {background:#f5f5ff; padding:20px; border-radius:12px; margin-bottom:30px; border-left:5px solid #667eea;}
.category-header {font-size:1.3em; font-weight:700; color:#667eea; margin-bottom:15px;}
button {padding:12px 24px; background:#667eea; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:600; transition:0.3s; font-size:1em;}
button:hover {background:#764ba2; transform:translateY(-2px); box-shadow:0 4px 12px rgba(102,126,234,0.3);}
.period-info {background:#e3f2fd; border-left:5px solid #2196F3; padding:15px; margin-bottom:20px; border-radius:6px;}
.period-info strong {color:#1565c0;}
.top-item {background:linear-gradient(135deg, #fff9e6 0%, #ffe8cc 100%); padding:12px; border-radius:8px; margin-bottom:10px; border-left:4px solid #ffc107;}
.chart-container {position:relative; height:400px; margin-bottom:30px;}
</style>
</head>
<body>
<div class="container">
<header>
<h1>üìä Wildberries Analytics Dashboard</h1>
<p>–ü–æ–ª–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –ø–µ—Ä–∏–æ–¥–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ —Ç–æ–≤–∞—Ä–∞–º</p>
</header>

<div class="period-selector">
<label for="period-select">üóìÔ∏è –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥:</label>
<select id="period-select" onchange="switchPeriod()">
<option value="period1">10.10-11.11.2025 (–¢–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥)</option>
<option value="period0">10.09-10.10.2025 (–°–µ–Ω—Ç—è–±—Ä—å-–û–∫—Ç—è–±—Ä—å)</option>
</select>
</div>

<div class="tabs">
<button class="tab-button active" onclick="switchTab('overview')">üìà –û–±–∑–æ—Ä</button>
<button class="tab-button" onclick="switchTab('products')">üì¶ –¢–æ–≤–∞—Ä—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
<button class="tab-button" onclick="switchTab('history')">üìö –ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–∏–æ–¥–æ–≤</button>
<button class="tab-button" onclick="switchTab('charts')">üìä –ì—Ä–∞—Ñ–∏–∫–∏</button>
</div>

<!-- –í–ö–õ–ê–î–ö–ê 1: –û–ë–ó–û–† -->
<div id="overview" class="tab-content active">
<div class="period-info">
<strong>–ü–µ—Ä–∏–æ–¥:</strong> <span id="period-name">10.10-11.11.2025</span>
</div>

<h2>–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h2>
<div class="metrics-grid" id="metrics-container"></div>

<h2>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–≤–æ–¥–∫–∞</h2>
<div class="scroll-table">
<table id="finance-table">
<thead>
<tr><th>–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th><th>–ó–Ω–∞—á–µ–Ω–∏–µ</th><th>% –æ—Ç –≤—ã—Ä—É—á–∫–∏</th></tr>
</thead>
<tbody id="finance-tbody"></tbody>
</table>
</div>
</div>

<!-- –í–ö–õ–ê–î–ö–ê 2: –¢–û–í–ê–†–´ –ò –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
<div id="products" class="tab-content">
<h2>üì¶ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–æ–≤–∞—Ä–∞–º</h2>

<h3>–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
<div class="metrics-grid">
<div class="metric-card">
<h3>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</h3>
<div class="value" id="total-orders">1,027</div>
</div>
<div class="metric-card">
<h3>–¢–æ–≤–∞—Ä–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h3>
<div class="value">4</div>
</div>
<div class="metric-card">
<h3>–†–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–µ–π</h3>
<div class="value">29</div>
</div>
<div class="metric-card">
<h3>–¢–û–ü-10 –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç</h3>
<div class="value">81.8%</div>
<div class="subtitle">–≤—Å–µ—Ö –ø—Ä–æ–¥–∞–∂</div>
</div>
</div>

<h3>üìå –ü–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å–µ - 929 –∑–∞–∫–∞–∑–æ–≤ (90.5%)</h3>
<div class="category-section">
<div class="category-header">–¢–æ–ø-10 —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–µ–π –ü–ë</div>
<div class="scroll-table">
<table>
<thead>
<tr><th>–ú–µ—Å—Ç–æ</th><th>–†–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç—å</th><th>–ö–æ–ª-–≤–æ</th><th>% –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</th><th>% –æ—Ç –æ–±—â–µ–≥–æ</th></tr>
</thead>
<tbody>
<tr><td>ü•á</td><td>–ü–ë 2—Å–ø —á–µ–ª–æ–≤–µ–∫ –ø–∞—É–∫</td><td>231</td><td>24.9%</td><td>22.5%</td></tr>
<tr><td>ü•à</td><td>–ü–ë 1.5—Å–ø –≥—É—Å—å –æ–±–Ω–∏–º—É—Å—å</td><td>120</td><td>12.9%</td><td>11.7%</td></tr>
<tr><td>ü•â</td><td>–ü–ë 1.5—Å–ø –¥–ª—è –¥–µ–≤–æ—á–∫–∏</td><td>99</td><td>10.7%</td><td>9.6%</td></tr>
<tr><td>4</td><td>–ü–ë 2—Å–ø –≥—É—Å—å –æ–±–Ω–∏–º—É—Å—å</td><td>87</td><td>9.4%</td><td>8.5%</td></tr>
<tr><td>5</td><td>–ü–ë 1.5—Å–ø —á–µ–ª–æ–≤–µ–∫ –ø–∞—É–∫</td><td>76</td><td>8.2%</td><td>7.4%</td></tr>
<tr><td>6</td><td>–ü–ë 2—Å–ø –∫–æ—Ç–∏–∫–∏</td><td>73</td><td>7.9%</td><td>7.1%</td></tr>
<tr><td>7</td><td>–ü–ë 2—Å–ø –¥–ª—è –¥–µ–≤–æ—á–∫–∏</td><td>51</td><td>5.5%</td><td>5.0%</td></tr>
<tr><td>8</td><td>–ü–ë 2—Å–ø –¥–ª—è –¥–µ–≤–æ—á–∫–∏ —Ä–æ–∑–æ–≤–æ–µ</td><td>43</td><td>4.6%</td><td>4.2%</td></tr>
<tr><td>9</td><td>–ü–ë 1.5—Å–ø —Å –∫–æ—Ç–∏–∫–∞–º–∏</td><td>34</td><td>3.7%</td><td>3.3%</td></tr>
<tr><td>10</td><td>–ü–ë 2—Å–ø –∫–∞–ø–∏–±–∞—Ä–∞</td><td>28</td><td>3.0%</td><td>2.7%</td></tr>
</tbody>
</table>
</div>

<div style="margin-top:20px; background:#fff9e6; padding:15px; border-radius:8px; border-left:4px solid #ffc107;">
<strong>üìä –ê–Ω–∞–ª–∏–∑ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º –ü–ë:</strong><br>
‚Ä¢ <strong>2 —Å–ø–∞–ª—å–Ω–æ–µ:</strong> 543 —à—Ç (58.4%)<br>
‚Ä¢ <strong>1.5 —Å–ø–∞–ª—å–Ω–æ–µ:</strong> 368 —à—Ç (39.6%)<br>
‚Ä¢ <strong>–ï–≤—Ä–æ:</strong> 18 —à—Ç (1.9%)
</div>
</div>

<h3>üìå –ü–ª–µ–¥—ã - 57 –∑–∞–∫–∞–∑–æ–≤ (5.6%)</h3>
<div class="category-section">
<table>
<thead>
<tr><th>–†–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç—å</th><th>–ö–æ–ª-–≤–æ</th><th>% –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</th></tr>
</thead>
<tbody>
<tr><td>–ü–ª–µ–¥ –≥—É—Å—å –æ–±–Ω–∏–º—É—Å—å 150—Ö200 –ø–ª—é—à–µ–≤—ã–π</td><td>34</td><td>59.6%</td></tr>
<tr><td>–ü–ª–µ–¥ 150—Ö200 –ø–ª—é—à–µ–≤—ã–π —Ç–µ–ø–ª—ã–π</td><td>13</td><td>22.8%</td></tr>
<tr><td>–ü–ª–µ–¥ 150—Ö200 –Ω–∞ –¥–∏–≤–∞–Ω —Ä–æ–∑–æ–≤—ã–π</td><td>10</td><td>17.5%</td></tr>
</tbody>
</table>
</div>

<h3>üìå –ü–æ–¥—É—à–∫–∏ - 36 –∑–∞–∫–∞–∑–æ–≤ (3.5%)</h3>
<div class="category-section">
<table>
<thead>
<tr><th>–†–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç—å</th><th>–ö–æ–ª-–≤–æ</th><th>% –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</th></tr>
</thead>
<tbody>
<tr><td>–ü–æ–¥—É—à–∫–∞ 70—Ö70 1 —à—Ç</td><td>26</td><td>72.2%</td></tr>
<tr><td>–ü–æ–¥—É—à–∫–∏ 70—Ö70 2 —à—Ç (–Ω–∞–±–æ—Ä)</td><td>10</td><td>27.8%</td></tr>
</tbody>
</table>
</div>

<h3>üìå –û–¥–µ—è–ª–∞ - 5 –∑–∞–∫–∞–∑–æ–≤ (0.5%)</h3>
<div class="category-section">
<table>
<thead>
<tr><th>–†–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç—å</th><th>–ö–æ–ª-–≤–æ</th><th>% –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</th></tr>
</thead>
<tbody>
<tr><td>–û–¥–µ—è–ª–æ 1.5 –≤—Å–µ—Å–µ–∑–æ–Ω–Ω–æ–µ —à–µ–ª–∫–æ–ø—Ä—è–¥</td><td>4</td><td>80.0%</td></tr>
<tr><td>–û–¥–µ—è–ª–æ 200—Ö220 –≤—Å–µ—Å–µ–∑–æ–Ω–Ω–æ–µ —à–µ–ª–∫–æ–ø—Ä—è–¥</td><td>1</td><td>20.0%</td></tr>
</tbody>
</table>
</div>

<h3>üèÜ –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
<div class="scroll-table">
<table>
<thead>
<tr><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–ö–æ–ª-–≤–æ</th><th>% –æ—Ç –æ–±—â–µ–≥–æ</th><th>–†–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–µ–π</th><th>–°—Ä–µ–¥–Ω–µ–µ –Ω–∞ –≤–∞—Ä–∏–∞–Ω—Ç</th></tr>
</thead>
<tbody>
<tr style="font-weight:700; background:#f0f4ff;"><td>–ü–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å–µ</td><td>929</td><td>90.5%</td><td>22</td><td>42.2</td></tr>
<tr><td>–ü–ª–µ–¥—ã</td><td>57</td><td>5.6%</td><td>3</td><td>19.0</td></tr>
<tr><td>–ü–æ–¥—É—à–∫–∏</td><td>36</td><td>3.5%</td><td>2</td><td>18.0</td></tr>
<tr><td>–û–¥–µ—è–ª–∞</td><td>5</td><td>0.5%</td><td>2</td><td>2.5</td></tr>
<tr style="font-weight:700; background:#667eea; color:white;"><td>–í–°–ï–ì–û</td><td>1,027</td><td>100%</td><td>29</td><td>35.4</td></tr>
</tbody>
</table>
</div>

<h3>üí° –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h3>
<div style="background:#f5f5ff; padding:20px; border-radius:8px; border-left:5px solid #667eea;">
<p>‚úÖ <strong>–ü–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å–µ - –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–≤–∞—Ä</strong> (90.5% –ø—Ä–æ–¥–∞–∂)<br>
‚úÖ <strong>–¢–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç 81.8%</strong> –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤<br>
‚ö†Ô∏è <strong>–û–¥–µ—è–ª–∞ —Å–ª–∞–±–æ —Ä–∞–∑–≤–∏—Ç—ã</strong> (—Ç–æ–ª—å–∫–æ 0.5%)<br>
üí° <strong>–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–∞–∑–≤–∏—Ç–∏—è:</strong> –†–∞—Å—à–∏—Ä–∏—Ç—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –ø–ª–µ–¥–æ–≤ –∏ –æ–¥–µ—è–ª
</p>
</div>
</div>

<!-- –í–ö–õ–ê–î–ö–ê 3: –ò–°–¢–û–†–ò–Ø –ü–ï–†–ò–û–î–û–í -->
<div id="history" class="tab-content">
<h2>üìö –ò—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–∏–æ–¥–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h2>

<h3>–í—Å–µ –ø–µ—Ä–∏–æ–¥—ã –≤ —Å–∏—Å—Ç–µ–º–µ</h3>
<div class="scroll-table">
<table id="all-periods-table">
<thead>
<tr>
<th>‚Ññ</th>
<th>–ü–µ—Ä–∏–æ–¥</th>
<th>–ó–∞–∫–∞–∑—ã</th>
<th>–í—ã—Ä—É—á–∫–∞</th>
<th>–õ–æ–≥–∏—Å—Ç–∏–∫–∞ %</th>
<th>–ü—Ä–∏–±—ã–ª—å</th>
<th>–ú–∞—Ä–∂–∞ %</th>
<th>–î–µ–π—Å—Ç–≤–∏—è</th>
</tr>
</thead>
<tbody id="all-periods-tbody"></tbody>
</table>
</div>

<h3 style="margin-top:40px;">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤</h3>
<div class="scroll-table">
<table id="comparison-table">
<thead>
<tr>
<th>–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>
<th>10.09-10.10</th>
<th>10.10-11.11</th>
<th>–†–∞–∑–Ω–∏—Ü–∞</th>
<th>–î–∏–Ω–∞–º–∏–∫–∞ %</th>
</tr>
</thead>
<tbody id="comparison-tbody"></tbody>
</table>
</div>
</div>

<!-- –í–ö–õ–ê–î–ö–ê 4: –ì–†–ê–§–ò–ö–ò -->
<div id="charts" class="tab-content">
<h2>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
<p>–ì—Ä–∞—Ñ–∏–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏</p>
</div>
</div>

<script>
// ========== –î–ê–ù–ù–´–ï –ü–ï–†–ò–û–î–û–í ==========
let periodsStorage = {
  period0: {
    name: '10.09-10.10 (–°–µ–Ω—Ç—è–±—Ä—å-–û–∫—Ç—è–±—Ä—å)',
    orders: 643,
    revenue: 824366.05,
    logistics: 178575.03,
    withholdings: 76586.00,
    storage: 128.49,
    profit: 195276.53,
    cogs: 373800.00,
    returns: 102
  },
  period1: {
    name: '10.10-11.11.2025 (–¢–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥)',
    orders: 1239,
    revenue: 1861876.81,
    logistics: 478843.63,
    withholdings: 174674.86,
    storage: 314.71,
    profit: 150090.47,
    cogs: 719860.00,
    returns: 104
  }
};

let currentPeriod = 'period1';

// ========== –§–£–ù–ö–¶–ò–ò ==========
function switchPeriod() {
  const select = document.getElementById('period-select');
  currentPeriod = select.value;
  updateDisplay();
}

function updateDisplay() {
  const period = periodsStorage[currentPeriod];
  
  document.getElementById('period-name').textContent = period.name;
  
  // –ú–µ—Ç—Ä–∏–∫–∏
  const metricsHtml = `
    <div class="metric-card">
      <h3>–ó–∞–∫–∞–∑—ã</h3>
      <div class="value">${period.orders}</div>
      <div class="subtitle">–µ–¥–∏–Ω–∏—Ü</div>
    </div>
    <div class="metric-card">
      <h3>–í—ã—Ä—É—á–∫–∞</h3>
      <div class="value">‚ÇΩ${(period.revenue / 1000000).toFixed(2)}M</div>
      <div class="subtitle">–≤—Å–µ–≥–æ</div>
    </div>
    <div class="metric-card">
      <h3>–ü—Ä–∏–±—ã–ª—å</h3>
      <div class="value">‚ÇΩ${(period.profit / 1000).toFixed(0)}K</div>
      <div class="subtitle">${(period.profit / period.revenue * 100).toFixed(1)}% –º–∞—Ä–∂–∞</div>
    </div>
    <div class="metric-card">
      <h3>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</h3>
      <div class="value">‚ÇΩ${(period.revenue / period.orders).toFixed(0)}</div>
      <div class="subtitle">–∑–∞ –∑–∞–∫–∞–∑</div>
    </div>
  `;
  document.getElementById('metrics-container').innerHTML = metricsHtml;
  
  // –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞
  const logisticsPct = (period.logistics / period.revenue * 100).toFixed(2);
  const withholdingsPct = (period.withholdings / period.revenue * 100).toFixed(2);
  const storagePct = (period.storage / period.revenue * 100).toFixed(2);
  const cogsPct = (period.cogs / period.revenue * 100).toFixed(2);
  const profitPct = (period.profit / period.revenue * 100).toFixed(2);
  
  const financeHtml = `
    <tr><td><strong>–í—ã—Ä—É—á–∫–∞</strong></td><td><strong>‚ÇΩ${period.revenue.toLocaleString('ru-RU', {maximumFractionDigits:2})}</strong></td><td>100.00%</td></tr>
    <tr><td>–õ–æ–≥–∏—Å—Ç–∏–∫–∞</td><td>‚ÇΩ${period.logistics.toLocaleString('ru-RU', {maximumFractionDigits:2})}</td><td>${logisticsPct}%</td></tr>
    <tr><td>–£–¥–µ—Ä–∂–∞–Ω–∏—è</td><td>‚ÇΩ${period.withholdings.toLocaleString('ru-RU', {maximumFractionDigits:2})}</td><td>${withholdingsPct}%</td></tr>
    <tr><td>–•—Ä–∞–Ω–µ–Ω–∏–µ</td><td>‚ÇΩ${period.storage.toLocaleString('ru-RU', {maximumFractionDigits:2})}</td><td>${storagePct}%</td></tr>
    <tr><td>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</td><td>‚ÇΩ${period.cogs.toLocaleString('ru-RU', {maximumFractionDigits:2})}</td><td>${cogsPct}%</td></tr>
    <tr style="background:#667eea; color:white;"><td><strong>–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</strong></td><td><strong>‚ÇΩ${period.profit.toLocaleString('ru-RU', {maximumFractionDigits:2})}</strong></td><td><strong>${profitPct}%</strong></td></tr>
  `;
  document.getElementById('finance-tbody').innerHTML = financeHtml;
  
  updateAllPeriodsTable();
  updateComparison();
}

function updateAllPeriodsTable() {
  const tbody = document.getElementById('all-periods-tbody');
  tbody.innerHTML = '';
  
  let idx = 1;
  for (const [key, period] of Object.entries(periodsStorage)) {
    const logisticsPct = (period.logistics / period.revenue * 100).toFixed(1);
    const profitPct = (period.profit / period.revenue * 100).toFixed(1);
    
    const row = `
      <tr>
        <td><strong>${idx}</strong></td>
        <td><strong>${period.name}</strong></td>
        <td>${period.orders}</td>
        <td>‚ÇΩ${period.revenue.toLocaleString('ru-RU', {maximumFractionDigits:0})}</td>
        <td>${logisticsPct}%</td>
        <td>‚ÇΩ${period.profit.toLocaleString('ru-RU', {maximumFractionDigits:0})}</td>
        <td style="color:#667eea; font-weight:700;">${profitPct}%</td>
        <td>
          <button style="padding:5px 10px; font-size:0.9em;" onclick="selectPeriod('${key}')">–í—ã–±—Ä–∞—Ç—å</button>
        </td>
      </tr>
    `;
    tbody.innerHTML += row;
    idx++;
  }
}

function selectPeriod(key) {
  document.getElementById('period-select').value = key;
  switchPeriod();
}

function updateComparison() {
  const p0 = periodsStorage.period0;
  const p1 = periodsStorage.period1;
  
  const compare = [
    {name: '–ó–∞–∫–∞–∑—ã', v0: p0.orders, v1: p1.orders},
    {name: '–í—ã—Ä—É—á–∫–∞', v0: p0.revenue, v1: p1.revenue},
    {name: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', v0: p0.logistics, v1: p1.logistics},
    {name: '–£–¥–µ—Ä–∂–∞–Ω–∏—è', v0: p0.withholdings, v1: p1.withholdings},
    {name: '–ü—Ä–∏–±—ã–ª—å', v0: p0.profit, v1: p1.profit}
  ];
  
  let html = '';
  compare.forEach(item => {
    const diff = item.v1 - item.v0;
    const pct = ((diff / item.v0) * 100).toFixed(1);
    const arrow = diff > 0 ? 'üìà' : 'üìâ';
    
    html += `
      <tr>
        <td><strong>${item.name}</strong></td>
        <td>${item.v0.toLocaleString('ru-RU', {maximumFractionDigits:0})}</td>
        <td>${item.v1.toLocaleString('ru-RU', {maximumFractionDigits:0})}</td>
        <td style="color:${diff > 0 ? '#4CAF50' : '#f44336'}"><strong>${diff > 0 ? '+' : ''}${diff.toLocaleString('ru-RU', {maximumFractionDigits:0})}</strong></td>
        <td style="color:${diff > 0 ? '#4CAF50' : '#f44336'}; font-weight:700;">${arrow} ${pct}%</td>
      </tr>
    `;
  });
  
  document.getElementById('comparison-tbody').innerHTML = html;
}

function switchTab(tabName) {
  document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
  document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
  document.getElementById(tabName).classList.add('active');
  event.target.classList.add('active');
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', () => {
  updateDisplay();
  updateAllPeriodsTable();
  updateComparison();
});
</script>
</body>
</html>
